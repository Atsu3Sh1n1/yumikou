<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ショートカット一覧</title>
  <style>
    .shortcut-category { display: none; margin: 5px 0; }
    .active { display: block; }
    button { margin: 5px; }
  </style>
</head>
<body>

  <h1>ショートカット一覧</h1>

  <!-- カテゴリ切り替えボタン -->
  <div>
    <button onclick="filterShortcuts('all')">すべて表示</button>
    <button onclick="filterShortcuts('Ctrl + [単キー]')">Ctrl + [単キー]</button>
    <button onclick="filterShortcuts('Ctrl + [Shift] + [キー]')">Ctrl + [Shift] + [キー]</button>
    <button onclick="filterShortcuts('Alt + [キー] シーケンス')">Alt + [キー] シーケンス</button>
    <button onclick="filterShortcuts('ファンクションキー')">ファンクションキー</button>
    <button onclick="filterShortcuts('Shift + ファンクションキー')">Shift + ファンクションキー</button>
    <button onclick="filterShortcuts('Ctrl + ファンクションキー')">Ctrl + ファンクションキー</button>
    <button onclick="filterShortcuts('その他の特殊組合せ')">その他の特殊組合せ</button>
  </div>

  <!-- 検索ボックス -->
  <input type="text" id="searchBox" placeholder="検索...">
  
  <!-- 結果表示 -->
  <div id="results"></div>

  <!-- ショートカット一覧 -->
  <div id="shortcutList"></div>

  <script>
    const categorizedShortcuts = {
      "Ctrl + [単キー]": [
        { "key": "Ctrl + 0", "action": "列を非表示" },
        { "key": "Ctrl + 1", "action": "[セルの書式設定]ダイアログを開く" },
        { "key": "Ctrl + 2", "action": "太字の切り替え" },
        { "key": "Ctrl + 3", "action": "斜体の切り替え" },
        { "key": "Ctrl + 4", "action": "下線の切り替え" },
        { "key": "Ctrl + 5", "action": "取消線の切り替え" },
        { "key": "Ctrl + 6", "action": "オブジェクトの表示/非表示切り替え" },
        { "key": "Ctrl + 7", "action": "[ツール]バーの表示切り替え" },
        { "key": "Ctrl + 8", "action": "アウトライン記号の表示切り替え" },
        { "key": "Ctrl + 9", "action": "行を非表示" },
        { "key": "Ctrl + A", "action": "全選択/数式全体選択" },
        { "key": "Ctrl + B", "action": "太字の切り替え" },
        { "key": "Ctrl + C", "action": "選択範囲をコピー" },
        { "key": "Ctrl + D", "action": "下方向にコピー" },
        { "key": "Ctrl + E", "action": "Flash Fill (データの自動展開)" },
        { "key": "Ctrl + F", "action": "[検索]ダイアログを開く" },
        { "key": "Ctrl + G", "action": "[ジャンプ]ダイアログを開く" },
        { "key": "Ctrl + H", "action": "[置換]ダイアログを開く" },
        { "key": "Ctrl + I", "action": "斜体の切り替え" },
        { "key": "Ctrl + J", "action": "改行文字入力 (環境依存)" },
        { "key": "Ctrl + K", "action": "[ハイパーリンクの挿入]ダイアログを開く" },
        { "key": "Ctrl + L", "action": "[テーブルの作成]ダイアログを開く" },
        { "key": "Ctrl + M", "action": "インデント増加 (環境依存)" },
        { "key": "Ctrl + N", "action": "新規ブックを作成" },
        { "key": "Ctrl + O", "action": "[ファイルを開く]ダイアログを開く" },
        { "key": "Ctrl + P", "action": "[印刷]ダイアログを開く" },
        { "key": "Ctrl + Q", "action": "[クイック分析]ツールを表示" },
        { "key": "Ctrl + R", "action": "右方向にコピー" },
        { "key": "Ctrl + S", "action": "上書き保存" },
        { "key": "Ctrl + T", "action": "[テーブルの作成]ダイアログを開く" },
        { "key": "Ctrl + U", "action": "下線の切り替え" },
        { "key": "Ctrl + V", "action": "貼り付け" },
        { "key": "Ctrl + W", "action": "ブックを閉じる" },
        { "key": "Ctrl + X", "action": "切り取り" },
        { "key": "Ctrl + Y", "action": "繰り返し" },
        { "key": "Ctrl + Z", "action": "元に戻す" }
      ],
      // 他のカテゴリーは省略、同様に定義していく...
    };

    const allShortcuts = Object.values(categorizedShortcuts).flat();

    document.getElementById("searchBox").addEventListener("input", function () {
      const query = this.value.toLowerCase();
      const resultsContainer = document.getElementById("results");

      if (query) {
        const result = allShortcuts.filter(item =>
          item.key.toLowerCase().includes(query) || item.action.includes(query)
        );

        resultsContainer.innerHTML = result.map(item =>
          `<li><strong>${item.key}</strong>: ${item.action}</li>`
        ).join("");
      } else {
        resultsContainer.innerHTML = "";
      }
    });

    function filterShortcuts(category) {
      const listContainer = document.getElementById("shortcutList");
      listContainer.innerHTML = ""; // 既存のリストをクリア

      if (category === "all") {
        renderFullList(); // すべて表示
      } else {
        const section = document.createElement("div");
        const title = document.createElement("h3");
        title.textContent = category;
        section.appendChild(title);

        const ul = document.createElement("ul");
        categorizedShortcuts[category].forEach(shortcut => {
          const li = document.createElement("li");
          li.innerHTML = `<strong>${shortcut.key}</strong>: ${shortcut.action}`;
          ul.appendChild(li);
        });

        section.appendChild(ul);
        listContainer.appendChild(section);
      }
    }

    function renderFullList() {
      const listContainer = document.getElementById("shortcutList");
      for (const category in categorizedShortcuts) {
        const section = document.createElement("div");
        const title = document.createElement("h3");
        title.textContent = category;
        section.appendChild(title);

        const ul = document.createElement("ul");
        categorizedShortcuts[category].forEach(shortcut => {
          const li = document.createElement("li");
          li.innerHTML = `<strong>${shortcut.key}</strong>: ${shortcut.action}`;
          ul.appendChild(li);
        });

        section.appendChild(ul);
        listContainer.appendChild(section);
      }
    }

    // 初期表示で全リストを表示
    renderFullList();
  </script>

</body>
</html>
