<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>足場施工費計算機</title>
<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        margin: 1em;
        max-width: 100%;
        font-size: 1rem;
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
    }

     h3 {
        font-size: 1.3em;
        margin: 0.8em 0 0.5em;
    }
      h2 {
      text-align: center;
      margin-bottom: -30px;
      font-size: 1.8rem;
    }
      h1 {
      text-align: center;
      margin-bottom: 10px;
      font-size: 1rem;
    }


    label {
        display: block;
        margin: 0.8em 0 0.3em;
    }

    input[type="number"] {
        width: 100%;
        max-width: 120px;
        padding: 8px;
        font-size: 1em;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-sizing: border-box;
    }

    #result, #totalCost, #sellingPrice, #manpowerCalc {
        margin: 1em 0;
        font-weight: bold;
        font-size: 1.1em;
        padding: 0.5em;
        background: #f5f5f5;
        border-radius: 4px;
    }

    .checkbox-group, .score-form {
        margin: 1em 0;
    }

    fieldset {
        margin: 0.8em 0;
        padding: 0.8em;
        border: 1px solid #eee;
        border-radius: 6px;
    }

    legend {
        font-weight: bold;
        font-size: 0.95em;
        padding: 0 0.5em;
    }

    .footnote {
        font-size: 0.8em;
        color: #666;
        margin: 1.5em 0;
        line-height: 1.4;
    }

    button {
        width: 100%;
        padding: 12px;
        background: #007aff;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 1em;
        margin: 1em 0;
        cursor: pointer;
    }

    /* ラジオボタンとチェックボックスのスタイル */
    input[type="radio"], input[type="checkbox"] {
        margin-right: 8px;
        transform: scale(1.2);
    }

    /* 印刷用スタイル（簡略化） */
    @media print {
        body {
            font-size: 12pt;
            padding: 0.5in;
        }
        button, .no-print {
            display: none;
        }
        #result, #totalCost, #sellingPrice, #manpowerCalc {
            font-size: 13pt;
        }
    }

    /* 横長スクリーン用の調整 */
    @media (min-width: 400px) {
        body {
            margin: 1em auto;
            max-width: 380px;
        }
    }
    .footer {
      text-align: center;
      font-size: 12px;
      margin-bottom: -10px;
      padding: 1.2rem;
    }

</style></head>

<body>
    <h2>足場施工費算出機</h2><br><h1>(マコト君１号)</h1>
    <div class="footer">
    <a href="https://atsu3sh1n1.github.io/yumikou/" target="_blank">Created by YUMIKOU Inc.</a>
  </div>

    <!-- 難易度スコアを上部に移動 -->
    <div class="score-form">
        <h3>難易度評価スコア</h3>
        <form id="difficultyForm">
            <fieldset>
                <legend>作業高さ</legend>
                <label><input type="radio" name="heightScore" value="1" checked> 地上〜2m</label>
                <label><input type="radio" name="heightScore" value="2"> 2〜5m</label>
                <label><input type="radio" name="heightScore" value="3"> 5〜10m</label>
                <label><input type="radio" name="heightScore" value="4"> 10〜15m</label>
                <label><input type="radio" name="heightScore" value="5"> 15m以上</label>
            </fieldset>

            <fieldset>
                <legend>搬入条件</legend>
                <label><input type="radio" name="transport" value="1" checked> 整地・近距離</label>
                <label><input type="radio" name="transport" value="2"> 小さな段差あり</label>
                <label><input type="radio" name="transport" value="3"> 100m以内手運び</label>
                <label><input type="radio" name="transport" value="4"> 100m超〜300m</label>
                <label><input type="radio" name="transport" value="5"> 300m超〜500m以上</label>
            </fieldset>

            <fieldset>
                <legend>足場支持地</legend>
                <label><input type="radio" name="base" value="1" checked> コンクリ平地</label>
                <label><input type="radio" name="base" value="2"> 軟弱地盤</label>
                <label><input type="radio" name="base" value="3"> 傾斜地</label>
                <label><input type="radio" name="base" value="4"> 配管上</label>
                <label><input type="radio" name="base" value="5"> 不安定</label>
            </fieldset>

            <fieldset>
                <legend>作業姿勢</legend>
                <label><input type="radio" name="posture" value="1" checked> 直立作業</label>
                <label><input type="radio" name="posture" value="2"> かがみ作業</label>
                <label><input type="radio" name="posture" value="3"> 懸垂あり</label>
                <label><input type="radio" name="posture" value="4"> 腰曲げ</label>
                <label><input type="radio" name="posture" value="5"> 狭小・不安定</label>
            </fieldset>

            <fieldset>
                <legend>環境要因</legend>
                <label><input type="radio" name="environment" value="1" checked> 常温・昼間</label>
                <label><input type="radio" name="environment" value="2"> 高温・湿気</label>
                <label><input type="radio" name="environment" value="3"> 夜間作業</label>
                <label><input type="radio" name="environment" value="4"> 有害ガス</label>
                <label><input type="radio" name="environment" value="5"> 爆発対応</label>
            </fieldset>

            <fieldset>
                <legend>干渉物</legend>
                <label><input type="radio" name="interference" value="1" checked> なし</label>
                <label><input type="radio" name="interference" value="2"> 少数配管</label>
                <label><input type="radio" name="interference" value="3"> 密集配管</label>
                <label><input type="radio" name="interference" value="4"> 電気設備多</label>
                <label><input type="radio" name="interference" value="5"> 360度密集</label>
            </fieldset>
        </form>

        <div id="scoreResult">合計スコア: 6 / 難易度補正係数: 1.0</div>
    </div>

    <!-- 基本入力セクション -->
    <div class="form-section">
        <label>
            人工単価（円／日）:
            <input type="number" id="laborCost" value="25000" min="0">
        </label>

        <label>
            作業床 面積（㎡）:
            <input type="number" id="area" placeholder="100" min="0">
        </label>

        <label>
            高さ（m）:
            <input type="number" id="height" value="6" min="0">
        </label>

        <!-- 追加1: 諸経費率入力欄 -->
        <label>
            諸経費率（％）:
            <input type="number" id="overheadRate" value="10" min="0" max="100">
        </label>

        <div class="checkbox-group">
            <strong>足場の種類（安全対応係数適用）:</strong>
            <label><input type="radio" name="type" value="1.00" checked> くさび式足場（係数 1.00）</label>
            <label><input type="radio" name="type" value="1.15"> 枠組足場（係数 1.15）</label>
            <label><input type="radio" name="type" value="1.30"> 単管足場（係数 1.30）</label>
            <label><input type="radio" name="type" value="1.50"> 吊り足場（係数 1.50）</label>
            <label><input type="radio" name="type" value="0.90"> 移動式足場（係数 0.90）</label>
        </div>
    </div>

    <!-- 計算結果表示セクション -->
    <div id="result">原価単価: 325.00 円／㎡</div>
    <div id="totalCost">合計金額: 195,000 円</div>
    <!-- 追加1: 見積金額（売値）表示 -->
    <div id="sellingPrice">見積金額（売値）: 214,500 円</div>

    <!-- 追加2: 人工数試算 -->
    <div id="manpowerCalc">必要人工数: 7.79 人日</div>

    <!-- 追加3: PDF出力/印刷ボタン -->
    <div class="no-print">
        <button onclick="window.print()">見積書を印刷/PDF出力</button>
    </div>

    <!-- 印刷時のみ表示されるヘッダー -->
    <div class="print-only">
        <h2>足場工事 見積書</h2>
        <p>見積日: <span id="printDate"></span></p>
        <hr>
    </div>

    <div class="footnote">
        ※ 国土交通省「公共建築工事標準単価積算基準」によれば、くさび式足場の施工量は77㎡／人工とされています。<br>
        <a href="https://www.mlit.go.jp/gobuild/content/001733127.pdf" target="_blank">出典：国交省 積算基準資料</a><br>
        難易度係数は作業環境6項目を元に評価。総スコアに応じて最大2.0倍まで加算されます。
    </div>

    <script>
        // 要素の取得
        const laborCostInput = document.getElementById('laborCost');
        const areaInput = document.getElementById('area');
        const heightInput = document.getElementById('height');
        const overheadRateInput = document.getElementById('overheadRate');
        const typeRadios = document.getElementsByName('type');
        const form = document.getElementById('difficultyForm');
        const resultDiv = document.getElementById('result');
        const totalCostDiv = document.getElementById('totalCost');
        const sellingPriceDiv = document.getElementById('sellingPrice');
        const manpowerCalcDiv = document.getElementById('manpowerCalc');
        const scoreResultDiv = document.getElementById('scoreResult');
        const printDateSpan = document.getElementById('printDate');
        const 施工量 = 77;

        // 安全係数の取得
        function getSafetyFactor() {
            for (const radio of typeRadios) {
                if (radio.checked) return parseFloat(radio.value);
            }
            return 1.00;
        }

        // 難易度係数の計算
        function getDifficultyFactor() {
            const formData = new FormData(form);
            let score = 0;
            for (const value of formData.values()) score += Number(value);

            let factor = 1.0;
            if (score >= 17) factor = 2.0;
            else if (score >= 13) factor = 1.5;
            else if (score >= 9) factor = 1.2;

            scoreResultDiv.innerText = `合計スコア: ${score} / 難易度補正係数: ${factor}`;
            return factor;
        }

        // 諸経費率を考慮した見積金額計算
        function calculateSellingPrice(baseCost) {
            const overheadRate = parseFloat(overheadRateInput.value) || 0;
            return baseCost * (1 + overheadRate / 100);
        }

        // 人工数の計算
        function calculateManpower(area, height) {
            if (!isNaN(area) && !isNaN(height)) {  // 両方の値が数値かチェック
                return (area * height) / 施工量;
            }
            return 0;
        }

        // 日付フォーマット
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}年${month}月${day}日`;
        }

        // メインの更新関数
        function updateAll() {
            const laborCost = parseFloat(laborCostInput.value);
            const area = parseFloat(areaInput.value);
            const height = parseFloat(heightInput.value);
            const safetyFactor = getSafetyFactor();
            const difficultyFactor = getDifficultyFactor();

            if (!isNaN(laborCost) && !isNaN(area) && !isNaN(height)) {
                const unitCost = laborCost / 施工量;
                const adjustedCost = unitCost * safetyFactor;
                const total = adjustedCost * area * height * difficultyFactor;
                const sellingPrice = calculateSellingPrice(total);
                const manpower = calculateManpower(area, height);

                resultDiv.textContent = `原価単価: ${(adjustedCost).toFixed(2)} 円／㎡`;
                totalCostDiv.textContent = `合計金額: ${Math.round(total).toLocaleString()} 円`;
                sellingPriceDiv.textContent = `見積金額（売値）: ${Math.round(sellingPrice).toLocaleString()} 円`;
                manpowerCalcDiv.textContent = `必要人工数: ${manpower.toFixed(2)} 人日`;
            } else {
                resultDiv.textContent = '原価単価: - 円／㎡';
                totalCostDiv.textContent = '合計金額: - 円';
                sellingPriceDiv.textContent = '見積金額（売値）: - 円';
                manpowerCalcDiv.textContent = '必要人工数: - 人日';
            }

            // 印刷用日付更新
            printDateSpan.textContent = formatDate(new Date());
        }

        // イベントリスナーの設定
        laborCostInput.addEventListener('input', updateAll);
        areaInput.addEventListener('input', updateAll);
        heightInput.addEventListener('input', updateAll);
        overheadRateInput.addEventListener('input', updateAll);
        typeRadios.forEach(r => r.addEventListener('change', updateAll));
        form.addEventListener('change', updateAll);

        // 初期表示
        updateAll();
    </script>
</body>

</html>