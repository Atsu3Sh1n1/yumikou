<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>正確施工費計算ツール</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 8px; max-width: 600px; margin: 20px auto; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #eee; }
    input[type="number"] { width: 80px; padding: 5px; }
    label { margin-right: 15px; }
    fieldset { margin-top: 20px; }
    #result { margin-top: 20px; font-size: 1.5em; font-weight: bold; }
  </style>
</head>
<body>

  <h2>足場施工費計算機（準備中）</h2>

  <table>
    <thead>
      <tr>
        <th>材料名</th>
        <th>単価（円）</th>
        <th>個数</th>
        <th>小計（円）</th>
      </tr>
    </thead>
    <tbody id="materialTable">
      <tr>
        <td>単管</td>
        <td><input type="number" class="unitPrice" value="800" min="0" /></td>
        <td><input type="number" class="quantity" value="0" min="0" /></td>
        <td class="subtotal">0</td>
      </tr>
      <tr>
        <td>クランプ</td>
        <td><input type="number" class="unitPrice" value="150" min="0" /></td>
        <td><input type="number" class="quantity" value="0" min="0" /></td>
        <td class="subtotal">0</td>
      </tr>
      <tr>
        <td>足場板</td>
        <td><input type="number" class="unitPrice" value="1200" min="0" /></td>
        <td><input type="number" class="quantity" value="0" min="0" /></td>
        <td class="subtotal">0</td>
      </tr>
      <tr>
        <td>ジャッキベース</td>
        <td><input type="number" class="unitPrice" value="500" min="0" /></td>
        <td><input type="number" class="quantity" value="0" min="0" /></td>
        <td class="subtotal">0</td>
      </tr>
    </tbody>
  </table>

  <label>
    基本人工単価（円／㎡）：
    <input type="number" id="baseLaborUnitPrice" value="4000" min="0" step="100" />
  </label>

  <label>
    施工面積（㎡）：
    <input type="number" id="area" value="100" min="0" step="0.1" />
  </label>

  <fieldset>
    <legend>施工条件係数（該当するものにチェック）</legend>
    <label><input type="checkbox" class="factor" value="1.2" /> 高所作業（1.2倍）</label>
    <label><input type="checkbox" class="factor" value="1.3" /> 狭所作業（1.3倍）</label>
    <label><input type="checkbox" class="factor" value="1.15" /> 安全対策強化（1.15倍）</label>
    <label><input type="checkbox" class="factor" value="1.1" /> 急工期（1.1倍）</label>
  </fieldset>

  <div id="result">施工費合計：0 円</div>

<script>
  const materialTable = document.getElementById('materialTable');
  const baseLaborUnitPriceInput = document.getElementById('baseLaborUnitPrice');
  const areaInput = document.getElementById('area');
  const factorCheckboxes = document.querySelectorAll('.factor');
  const resultDiv = document.getElementById('result');

  function calculate() {
    // 材料費合計
    let materialTotal = 0;
    const rows = materialTable.querySelectorAll('tr');
    rows.forEach(row => {
      const unitPriceInput = row.querySelector('.unitPrice');
      const quantityInput = row.querySelector('.quantity');
      const subtotalCell = row.querySelector('.subtotal');

      const unitPrice = parseFloat(unitPriceInput.value) || 0;
      const quantity = parseFloat(quantityInput.value) || 0;
      const subtotal = unitPrice * quantity;
      subtotalCell.textContent = subtotal.toLocaleString();
      materialTotal += subtotal;
    });

    // 基本人工費×面積×係数
    const baseLaborUnitPrice = parseFloat(baseLaborUnitPriceInput.value) || 0;
    const area = parseFloat(areaInput.value) || 0;

    let factor = 1;
    factorCheckboxes.forEach(cb => {
      if(cb.checked) {
        factor *= parseFloat(cb.value);
      }
    });

    const laborCost = baseLaborUnitPrice * area * factor;

    // 合計施工費
    const totalCost = materialTotal + laborCost;

    resultDiv.textContent = `施工費合計：${Math.floor(totalCost).toLocaleString()} 円`;
  }

  // イベント設定
  materialTable.addEventListener('input', calculate);
  baseLaborUnitPriceInput.addEventListener('input', calculate);
  areaInput.addEventListener('input', calculate);
  factorCheckboxes.forEach(cb => cb.addEventListener('change', calculate));

  window.onload = calculate;
</script>

</body>
</html>
