<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>é‹¼ç®¡é‡é‡è¨ˆç®—ï¼ˆæè³ªä¸€æ‹¬ãƒ»ã‚³ãƒ”ãƒ¼å¯¾å¿œï¼‰</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 30px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
    }
    input {
      width: 100%;
      box-sizing: border-box;
    }
    select {
      font-size: 1rem;
    }
    button {
      margin-top: 10px;
      margin-right: 10px;
    }
    .copy-message {
      color: green;
      font-size: 0.9em;
      margin-left: 10px;
    }

    .footer {
      text-align: center;
      margin-top: 10px;
      margin-bottom: 20px;
      font-size: 0.9em;
    }

     h2 {
      text-align: center;
      font-size: 1.8em;
      
    }

  </style>
</head>
<body>
  <h2>æ¥­å‹™ç”¨é‹¼ç®¡é‡é‡è¨ˆç®—</h2>
   <div class="footer">
      <a href="https://atsu3sh1n1.github.io/yumikou/" target="_blank">Created by YUMIKOU Inc.</a>
    </div>

  <label for="globalMaterial">æè³ªï¼ˆå…¨ä½“ï¼‰</label>
  <select id="globalMaterial" onchange="updateAllRows()">
    <option value="7850">ç‚­ç´ é‹¼ï¼ˆSTPGï¼‰</option>
    <option value="7930">ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹304</option>
    <option value="7920">ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹304L</option>
    <option value="8000">ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹316</option>
    <option value="7990">ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹316L</option>
    <option value="8900">éŠ…</option>
    <option value="2700">ã‚¢ãƒ«ãƒŸ</option>
    <option value="7200">é‹³é‰„</option>
    <option value="1400">å¡©ãƒ“</option>
    <option value="950">PE</option>
    <option value="4500">ãƒã‚¿ãƒ³</option>
  </select>

  <table id="pipeTable">
    <thead>
      <tr>
        <th>å¤–å¾„ (mm)</th>
        <th>è‚‰åš (mm)</th>
        <th>æ¯”é‡</th>
        <th>ç†è«–é‡é‡ (kg/m)</th>
      </tr>
    </thead>
    <tbody id="tableBody">
      <!-- åˆæœŸè¡Œ -->
    </tbody>
  </table>

  <div>
    <button onclick="addRow()">ï¼‹ è¡Œã‚’è¿½åŠ </button>
    <button onclick="copyResults()">ğŸ“‹ çµæœã‚’ã‚³ãƒ”ãƒ¼</button>
    <span id="copyMessage" class="copy-message"></span>
  </div>

  <script>
    function addRow() {
      const tbody = document.getElementById('tableBody');
      const row = document.createElement('tr');

      row.innerHTML = `
        <td><input type="number" step="0.1" class="od"></td>
        <td><input type="number" step="0.1" class="thickness"></td>
        <td><input type="number" step="1" class="density" readonly></td>
        <td class="weight">-</td>
      `;

      const inputs = row.querySelectorAll('input');
      inputs.forEach(input => {
        input.addEventListener('input', () => calculateRow(row));
      });

      tbody.appendChild(row);
      updateRowDensity(row);
      calculateRow(row);
    }

    function getGlobalDensity() {
      const select = document.getElementById('globalMaterial');
      return parseFloat(select.value);
    }

    function updateRowDensity(row) {
      const densityInput = row.querySelector('.density');
      densityInput.value = getGlobalDensity();
    }

    function updateAllRows() {
      const rows = document.querySelectorAll('#tableBody tr');
      rows.forEach(row => {
        updateRowDensity(row);
        calculateRow(row);
      });
    }

    function calculateRow(row) {
      const od = parseFloat(row.querySelector('.od').value);
      const t = parseFloat(row.querySelector('.thickness').value);
      const density = parseFloat(row.querySelector('.density').value);
      const resultCell = row.querySelector('.weight');

      if (isNaN(od) || isNaN(t) || isNaN(density) || t * 2 >= od) {
        resultCell.textContent = '-';
        return;
      }

      const id = od - 2 * t;
      const volume = (Math.PI / 4) * (od ** 2 - id ** 2) * 1e-6;
      const weight = volume * density;

      resultCell.textContent = weight.toFixed(3);
    }

    function copyResults() {
      const resultCells = document.querySelectorAll('.weight');
      const weights = Array.from(resultCells)
        .map(cell => cell.textContent.trim())
        .filter(w => w !== '-' && w !== '');

      if (weights.length === 0) {
        showCopyMessage("ã‚³ãƒ”ãƒ¼å¯¾è±¡ãŒã‚ã‚Šã¾ã›ã‚“", false);
        return;
      }

      const text = weights.join('\n');
      navigator.clipboard.writeText(text).then(() => {
        showCopyMessage("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼", true);
      }).catch(() => {
        showCopyMessage("ã‚³ãƒ”ãƒ¼å¤±æ•—", false);
      });
    }

    function showCopyMessage(message, success) {
      const msgEl = document.getElementById('copyMessage');
      msgEl.textContent = message;
      msgEl.style.color = success ? 'green' : 'red';
      setTimeout(() => msgEl.textContent = '', 3000);
    }

    // åˆæœŸè¡Œ
    addRow();
  </script>
</body>
</html>
